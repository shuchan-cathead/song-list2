<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>🎶 歌のリスト</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background-size: cover; background-repeat: no-repeat; background-position: center; transition: background-image 0.3s ease, background-color 0.3s ease; color: #000; min-height: 100vh; }
    h1 { margin-bottom: 10px; }
    .settings-toggle { position: fixed; bottom: 10px; right: 10px; z-index: 1000; }
    .settings-panel { position: fixed; bottom: 0; left: 0; width: 100%; background: rgba(255,255,255,0.9); border-top:1px solid #ccc; padding:10px; display:none; z-index:999; font-size:14px; }
    .settings-panel input[type="text"], .settings-panel input[type="range"], .settings-panel input[type="color"], .settings-panel input[type="file"] { margin:3px; }
    button { padding:5px 10px; margin:2px; font-size:14px; }
    table { width:100%; border-collapse: collapse; margin-top:10px; background: rgba(255,255,255,0.95); }
    th, td { border:1px solid #ccc; padding:8px; text-align:left; }
    th { background-color:#f0f0f0; cursor:pointer; }
    .pagination { margin-top:10px; text-align:center; }
    .pagination button { margin:0 5px; }
    @media(max-width:600px) { body, .settings-panel { font-size:12px; } table,th,td { font-size:12px; } button,input { font-size:11px; } }
  </style>
</head>
<body>
  <h1 id="pageTitle">🎶 歌のリスト</h1>
  <div>
    <input type="text" id="newTitle" placeholder="曲名">
    <input type="text" id="newArtist" placeholder="アーティスト名">
    <button onclick="addSong()">追加</button>
  </div>
  <table id="songTable">
    <thead><tr>
      <th onclick="sortBy('index')">#</th>
      <th onclick="sortBy('title')">曲名 ▲▼</th>
      <th onclick="sortBy('artist')">アーティスト ▲▼</th>
      <th>操作</th>
    </tr></thead>
    <tbody></tbody>
  </table>
  <div class="pagination">
    <button onclick="prevPage()">⏮ 前へ</button>
    <span id="pageInfo"></span>
    <button onclick="nextPage()">次へ ⏭</button>
  </div>
  <div class="settings-toggle"><button onclick="toggleSettings()">⚙️ 設定</button></div>
  <div class="settings-panel" id="settingsPanel">
    <div><label>ページタイトル：</label><input type="text" id="pageTitleInput" oninput="updateTitle()"></div>
    <div><label>背景URL：</label><input type="text" id="bgUrlInput" oninput="updateBackground()"><label>画像：</label><input type="file" id="bgUpload" accept="image/*" onchange="uploadBackground()"><button onclick="resetBackground()">リセット</button></div>
    <div><label>背景透明度：</label><input type="range" min="0" max="1" step="0.01" id="bgOpacity" value="0.9" oninput="updateOpacity()"></div>
    <div><label>文字色：</label><input type="color" id="textColor" value="#000000" onchange="updateTextColor()"></div>
    <div><button onclick="saveSettings()">設定保存</button><button onclick="loadSettings()">設定復元</button></div>
    <div><button onclick="saveSongs()">曲リスト保存</button><button onclick="loadSongs()">曲リスト復元</button></div>
  </div>
<script>
  const pageSize = 20;
  let songs = JSON.parse(localStorage.getItem("songList") || "[]");
  let currentPage = 1, sortKey = null, sortAsc = true;
  function renderTable(){
    let arr = [...songs];
    if(sortKey){
      arr.sort((a,b)=>sortAsc ? (a[sortKey]||'').localeCompare(b[sortKey]||'') : (b[sortKey]||'').localeCompare(a[sortKey]||''));
    }
    const tbody = document.querySelector("#songTable tbody"); tbody.innerHTML="";
    const start = (currentPage-1)*pageSize;
    const pageArr = arr.slice(start, start+pageSize);
    pageArr.forEach((song,i)=>{
      const tr = document.createElement("tr");
      tr.innerHTML = `<td>${start+i+1}</td><td>${song.title}</td><td>${song.artist}</td><td><button onclick="editSong(${songs.indexOf(song)})">編集</button><button onclick="deleteSong(${songs.indexOf(song)})">削除</button></td>`;
      tbody.appendChild(tr);
    });
    document.getElementById("pageInfo").textContent=`ページ ${currentPage} / ${Math.max(Math.ceil(songs.length/pageSize),1)}`;
  }
  function addSong(){const t=document.getElementById("newTitle").value.trim(),a=document.getElementById("newArtist").value.trim();if(!t||!a)return alert("曲名とアーティスト名を入力してください");songs.push({title:t,artist:a});saveSongs();document.getElementById("newTitle").value="";document.getElementById("newArtist").value="";renderTable();}
  function editSong(i){const s=songs[i],t=prompt("曲名",s.title),a=prompt("アーティスト",s.artist);if(t&&a){songs[i]={title:t.trim(),artist:a.trim()};saveSongs();renderTable();}}
  function deleteSong(i){if(confirm("本当に削除しますか？")){songs.splice(i,1);saveSongs();if(currentPage>Math.ceil(songs.length/pageSize))currentPage--;renderTable();}}
  function sortBy(key){ if(sortKey===key) sortAsc=!sortAsc; else {sortKey=key;sortAsc=true;} renderTable();}
  function nextPage(){if(currentPage<Math.ceil(songs.length/pageSize)){currentPage++;renderTable();}}
  function prevPage(){if(currentPage>1){currentPage--;renderTable();}}
  function toggleSettings(){const p=document.getElementById("settingsPanel");p.style.display=(p.style.display==="block"?"none":"block");}
  function updateTitle(){document.getElementById("pageTitle").textContent=document.getElementById("pageTitleInput").value||"🎶 歌のリスト";}
  function updateBackground(){document.body.style.backgroundImage = document.getElementById("bgUrlInput").value?"url('"+document.getElementById("bgUrlInput").value+"')":'none';}
  function uploadBackground(){const f=document.getElementById("bgUpload").files[0];if(f){const r=new FileReader();r.onload=e=>{document.body.style.backgroundImage=`url('${e.target.result}')`;localStorage.setItem("bgImage",e.target.result)};r.readAsDataURL(f);}}
  function resetBackground(){document.body.style.backgroundImage='none';document.getElementById("bgUrlInput").value='';localStorage.removeItem("bgImage");}
  function updateOpacity(){document.body.style.backgroundColor=`rgba(255,255,255,${1-document.getElementById("bgOpacity").value})`;}
  function updateTextColor(){document.body.style.color=document.getElementById("textColor").value;}
  function saveSettings(){localStorage.setItem("pageTitle",document.getElementById("pageTitleInput").value);localStorage.setItem("textColor",document.getElementById("textColor").value);localStorage.setItem("bgOpacity",document.getElementById("bgOpacity").value);localStorage.setItem("bgUrl",document.getElementById("bgUrlInput").value);}
  function loadSettings(){document.getElementById("pageTitleInput").value=localStorage.getItem("pageTitle")||''; updateTitle();document.getElementById("textColor").value=localStorage.getItem("textColor")||'#000000'; updateTextColor();document.getElementById("bgOpacity").value=localStorage.getItem("bgOpacity")||0.9; updateOpacity(); document.getElementById("bgUrlInput").value=localStorage.getItem("bgUrl")||''; updateBackground(); const img=localStorage.getItem("bgImage"); if(img)document.body.style.backgroundImage=`url('${img}')`;}
  function saveSongs(){localStorage.setItem("songList",JSON.stringify(songs));}
  function loadSongs(){songs=JSON.parse(localStorage.getItem("songList")||"[]"); if(currentPage>Math.ceil(songs.length/pageSize))currentPage=1; renderTable();}
  window.onload=function(){loadSettings();loadSongs();renderTable();}
</script>
</body>
</html>
