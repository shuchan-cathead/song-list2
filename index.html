<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>🎶 歌のリスト</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center;
      transition: background-image 0.3s ease, background-color 0.3s ease;
      color: #000;
      min-height: 100vh;
    }
    h1 { margin-bottom: 10px; }
    button { padding: 5px 10px; margin: 2px; font-size: 14px; }
    input[type="text"] { margin: 3px; padding: 5px; font-size: 14px; }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      background: rgba(255, 255, 255, 0.95);
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: left;
    }
    th {
      background-color: #f0f0f0;
      cursor: pointer;
    }

    .pagination {
      margin-top: 10px;
      text-align: center;
    }

    .settings-toggle {
      position: fixed;
      bottom: 10px;
      right: 10px;
      z-index: 1000;
    }
    .settings-panel {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: rgba(255,255,255,0.9);
      border-top:1px solid #ccc;
      padding:10px;
      display:none;
      z-index:999;
      font-size:14px;
    }
    .settings-panel input[type="text"],
    .settings-panel input[type="range"],
    .settings-panel input[type="color"],
    .settings-panel input[type="file"] {
      margin:3px;
    }

    @media(max-width:600px){
      body, table, th, td, input, button, .settings-panel { font-size: 12px; }
    }
  </style>
</head>
<body>

<h1 id="pageTitle">🎶 歌のリスト</h1>

<div>
  <input type="text" id="newTitle" placeholder="曲名">
  <input type="text" id="newArtist" placeholder="アーティスト名">
  <input type="text" id="newUrl" placeholder="動画URL (省略可)">
  <button onclick="addSong()">追加</button>
</div>

<table id="songTable">
  <thead>
    <tr>
      <th>#</th>
      <th onclick="sortBy('title')">曲名 ▲▼</th>
      <th onclick="sortBy('artist')">アーティスト ▲▼</th>
      <th>動画</th>
      <th>操作</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<div class="pagination">
  <button onclick="prevPage()">⏮ 前へ</button>
  <span id="pageInfo"></span>
  <button onclick="nextPage()">次へ ⏭</button>
</div>

<!-- 設定ボタン -->
<div class="settings-toggle">
  <button onclick="toggleSettings()">⚙️ 設定</button>
</div>

<!-- 設定パネル -->
<div class="settings-panel" id="settingsPanel">
  <div><label>ページタイトル：</label><input type="text" id="pageTitleInput" oninput="updateTitle()"></div>
  <div><label>背景URL：</label><input type="text" id="bgUrlInput" oninput="updateBackground()"> <label>画像：</label><input type="file" id="bgUpload" accept="image/*" onchange="uploadBackground()"> <button onclick="resetBackground()">リセット</button></div>
  <div><label>背景透明度：</label><input type="range" min="0" max="1" step="0.01" id="bgOpacity" value="0.9" oninput="updateOpacity()"></div>
  <div><label>文字色：</label><input type="color" id="textColor" value="#000000" onchange="updateTextColor()"></div>
  <div><button onclick="saveSettings()">設定保存</button><button onclick="loadSettings()">設定復元</button></div>
</div>

<script>
// 以下のJavaScriptコードに、背景や文字色などの設定復元・保存処理が含まれています
// 既存のコードにこのまま統合すれば、すべて機能します
function toggleSettings() {
  const panel = document.getElementById("settingsPanel");
  panel.style.display = (panel.style.display === "block") ? "none" : "block";
}
function updateTitle() {
  document.getElementById("pageTitle").textContent = document.getElementById("pageTitleInput").value || "🎶 歌のリスト";
}
function updateBackground() {
  document.body.style.backgroundImage = document.getElementById("bgUrlInput").value ? `url('${document.getElementById("bgUrlInput").value}')` : 'none';
}
function uploadBackground() {
  const file = document.getElementById("bgUpload").files[0];
  if (file) {
    const reader = new FileReader();
    reader.onload = e => {
      document.body.style.backgroundImage = `url('${e.target.result}')`;
      localStorage.setItem("bgImage", e.target.result);
    };
    reader.readAsDataURL(file);
  }
}
function resetBackground() {
  document.body.style.backgroundImage = 'none';
  document.getElementById("bgUrlInput").value = '';
  localStorage.removeItem("bgImage");
}
function updateOpacity() {
  document.body.style.backgroundColor = `rgba(255,255,255,${1 - document.getElementById("bgOpacity").value})`;
}
function updateTextColor() {
  document.body.style.color = document.getElementById("textColor").value;
}
function saveSettings() {
  localStorage.setItem("pageTitle", document.getElementById("pageTitleInput").value);
  localStorage.setItem("textColor", document.getElementById("textColor").value);
  localStorage.setItem("bgOpacity", document.getElementById("bgOpacity").value);
  localStorage.setItem("bgUrl", document.getElementById("bgUrlInput").value);
}
function loadSettings() {
  document.getElementById("pageTitleInput").value = localStorage.getItem("pageTitle") || '';
  updateTitle();
  document.getElementById("textColor").value = localStorage.getItem("textColor") || '#000000';
  updateTextColor();
  document.getElementById("bgOpacity").value = localStorage.getItem("bgOpacity") || 0.9;
  updateOpacity();
  document.getElementById("bgUrlInput").value = localStorage.getItem("bgUrl") || '';
  updateBackground();
  const img = localStorage.getItem("bgImage");
  if (img) document.body.style.backgroundImage = `url('${img}')`;
}
window.onload = function () {
  loadSettings();
  // 他のloadSongsなどもここで呼び出し可
};
</script>

</body>
</html>
